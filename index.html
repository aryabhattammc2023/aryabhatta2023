<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans&display=swap">
    <link rel="shortcut icon" href="aryabhatta.jpg" type="image/x-icon">
    <title>Aryabhatta MMC 2023</title>
</head>
<body>
    <header>
        <div class="header-title">Aryabhatta Complaint Portal</div>
        <div class="header-image">
            <img src="aryabhatta.jpg" alt="Header Image">
        </div>
    </header>
    <div class="container">
        <h1></h1>
        <form id="complaintForm">
            <div class="form-group">
                <label for="name">Name <span class="required">*</span></label>
                <input type="text" id="name" name="name" required>
            </div>
            <div class="form-group">
                <label for="phone">Phone Number <span class="required">*</span></label>
                <input type="tel" id="phone" name="phone" required>
            </div>
            <div class="form-group">
                <label for="room">Room Number <span class="required">*</span></label>
                <input type="room" id="room" name="room" required>
            </div>
            <div class="form-group">
                <label for="date" hidden="true">Date</label>
                <input type="text" id="date" name="date" hidden="true">
            </div>
            <div class="form-group">
                <label for="complaint">Complaint & Time of Food <span class="required">*</span></label>
                <textarea id="complaint" name="complaint" rows="5" required></textarea>
            </div>
            <div class="form-group">
                <label for="image">Image (Optional)</label>
                <input type="file" id="image" name="image" accept="image/*">
            </div>
            <button id="submitButton" type="submit">Submit</button>
        </form>
        <div id="message" class="hidden"></div>
    </div>
    <footer>
        &copy; 2023 Aryabhatta MMC
    </footer>
    <script src="script.js"></script>
      <script>
        const scriptURL = 'https://script.google.com/macros/s/AKfycbzvOSwTr5k0c3fcOjKlRbHj1DTC8Rr0iR9JIMzHHpABIK1ux-WIMsZy48T2dQ15FijKyg/exec'
        const form = document.getElementById('complaintForm');
        const dateBox = document.getElementById('date');

        form.addEventListener('submit', e => {
            const phone = document.getElementById('phone').value;
            const cmptext = document.getElementById('complaint');
            console.log(phone.length);
            if(phone.length < 10 || phone.length > 10)
            {
                alert("Not a valid number...");
                return;
            }

            // Get the current date
            const currentDate = new Date();

            const dateString = currentDate.toLocaleDateString();
            if(currentDate.getMinutes() < 10)
            {
                const timeString = currentDate.getHours().toString() + ":0" + currentDate.getMinutes().toString();
            }else{
                const timeString = currentDate.getHours().toString() + ":" + currentDate.getMinutes().toString();
            }
            dateBox.value = dateString + "  " + timeString;
            
            e.preventDefault()
            fetch(scriptURL, { method: 'POST', body: new FormData(form)})
                .then(response => console.log('Success!'))
                .catch(error => console.error('Error!', error.message))
        })
    </script>
</body>
</html>
